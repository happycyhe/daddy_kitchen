<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Daddy's Kitchen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,600;1,600&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fdfbf7; color: #4a4a4a; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .check-item input:checked + label { text-decoration: line-through; color: #a0a0a0; }
        .check-item input:checked + label::before { background-color: #fbbf24; border-color: #fbbf24; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .spin-slow { animation: spin 8s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .memory-img { aspect-ratio: 1/1; object-fit: cover; border-radius: 0.5rem; }
    </style>
</head>
<body class="h-screen w-screen flex flex-col relative overflow-hidden">
    <header class="w-full px-6 py-4 flex justify-between items-center bg-white/80 backdrop-blur-md z-10 sticky top-0 border-b border-stone-100">
        <div class="flex items-center gap-2">
            <i class="fa-solid fa-utensils text-amber-500"></i>
            <h1 class="font-serif text-xl font-bold text-stone-800">Daddy's Kitchen</h1>
            <span id="server-status" class="w-2.5 h-2.5 rounded-full bg-red-400 animate-pulse shadow-sm" title="ì—°ê²° ëŒ€ê¸°"></span>
        </div>
        <div class="flex gap-4">
            <button onclick="window.openAddRecipeModal()" class="text-stone-600 hover:text-amber-500"><i class="fa-solid fa-plus text-xl"></i></button>
            <button onclick="window.toggleTimerModal()" class="text-stone-600 hover:text-amber-500"><i class="fa-regular fa-clock text-xl"></i></button>
        </div>
    </header>

    <main id="recipe-container" class="flex-1 overflow-y-auto pb-32 hide-scrollbar transition-opacity duration-300">
        <div class="flex flex-col items-center justify-center h-full text-stone-400">
            <i class="fa-solid fa-circle-notch fa-spin text-4xl text-amber-500 mb-4"></i>
            <p>ë ˆì‹œí”¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
        </div>
    </main>

    <div class="absolute bottom-0 w-full bg-white border-t border-stone-200 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] px-6 py-4 z-20">
        <div class="w-full bg-stone-200 h-1 rounded-full mb-4 overflow-hidden cursor-pointer" id="progress-container">
            <div id="progress-bar" class="bg-amber-500 h-full w-0 transition-all duration-100"></div>
        </div>
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-3 overflow-hidden">
                <div id="album-art" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center overflow-hidden shadow-md">
                    <img src="https://images.unsplash.com/photo-1459749411177-3a269496a607?w=100" class="w-full h-full object-cover opacity-80">
                </div>
                <div class="flex-1 min-w-0">
                    <p id="song-title" class="font-bold text-sm text-stone-800 truncate">Sunday Morning</p>
                    <p id="artist-name" class="text-xs text-stone-500 truncate">Cooking Jazz Trio</p>
                </div>
            </div>
            <div class="flex items-center gap-4 text-stone-700">
                <button onclick="window.prevSong()"><i class="fa-solid fa-backward-step"></i></button>
                <button onclick="window.togglePlay()" class="w-10 h-10 bg-amber-500 rounded-full text-white flex items-center justify-center shadow-md"><i id="play-icon" class="fa-solid fa-play ml-1"></i></button>
                <button onclick="window.nextSong()"><i class="fa-solid fa-forward-step"></i></button>
            </div>
        </div>
        <audio id="audio-player"></audio>
    </div>

    <div id="timer-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white rounded-3xl p-6 w-80 shadow-2xl text-center">
            <h3 class="text-xl font-bold mb-1">í‚¤ì¹œ íƒ€ì´ë¨¸</h3>
            <div class="text-5xl font-mono font-bold text-amber-500 mb-8 mt-6" id="timer-display">00:00</div>
            <div class="grid grid-cols-3 gap-2 mb-6">
                <button onclick="window.addTime(60)" class="bg-stone-100 py-2 rounded-lg">+1ë¶„</button>
                <button onclick="window.addTime(180)" class="bg-stone-100 py-2 rounded-lg">+3ë¶„</button>
                <button onclick="window.addTime(300)" class="bg-stone-100 py-2 rounded-lg">+5ë¶„</button>
            </div>
            <div class="flex gap-3">
                <button onclick="window.resetTimer()" class="flex-1 py-3 rounded-xl bg-stone-200">ì´ˆê¸°í™”</button>
                <button onclick="window.toggleTimer()" id="timer-btn" class="flex-1 py-3 rounded-xl bg-amber-500 text-white font-bold">ì‹œì‘</button>
            </div>
            <button onclick="window.toggleTimerModal()" class="mt-4 text-sm text-stone-400 underline">ë‹«ê¸°</button>
        </div>
    </div>
	<!-- ë ˆì‹œí”¼ ì¶”ê°€ ëª¨ë‹¬ (ì—…ê·¸ë ˆì´ë“œë¨) -->
    <div id="add-recipe-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-end sm:items-center justify-center backdrop-blur-sm">
        <div class="bg-white w-full sm:w-96 h-[90vh] sm:h-auto sm:rounded-3xl rounded-t-3xl p-6 shadow-2xl flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">ìƒˆ ë ˆì‹œí”¼</h3>
                <button onclick="window.closeAddRecipeModal()"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto space-y-4 pr-1 hide-scrollbar">
                <!-- ëŒ€í‘œ ì‚¬ì§„ ì—…ë¡œë“œ -->
                <div class="w-full h-40 bg-stone-100 rounded-xl border-2 border-dashed border-stone-300 flex flex-col items-center justify-center cursor-pointer hover:bg-stone-50 transition relative overflow-hidden" onclick="document.getElementById('cover-input').click()">
                    <img id="cover-preview" class="absolute inset-0 w-full h-full object-cover hidden">
                    <div id="cover-placeholder" class="text-center text-stone-400">
                        <i class="fa-solid fa-camera text-3xl mb-2"></i><p class="text-xs">ëŒ€í‘œ ì‚¬ì§„ ë“±ë¡</p>
                    </div>
                    <input type="file" id="cover-input" accept="image/*" hidden onchange="window.handleCoverUpload(event)">
                </div>

                <input type="text" id="new-title" class="w-full border rounded-xl px-4 py-2" placeholder="ìš”ë¦¬ ì´ë¦„ (í•„ìˆ˜)">
                <input type="text" id="new-subtitle" class="w-full border rounded-xl px-4 py-2" placeholder="ì˜ì–´ ë¶€ì œ (ì„ íƒ)">
                <div class="grid grid-cols-2 gap-2">
                    <input type="text" id="new-time" class="w-full border rounded-xl px-4 py-2" placeholder="ì‹œê°„ (ì˜ˆ: 15ë¶„)">
                    <input type="text" id="new-servings" class="w-full border rounded-xl px-4 py-2" placeholder="ì¸ë¶„ (ì˜ˆ: 1ì¸ë¶„)">
                </div>
                
                <!-- ì¬ë£Œ ì…ë ¥ -->
                <div>
                    <label class="block text-xs font-bold text-stone-500 mb-1">ì¬ë£Œ</label>
                    <div id="ingredient-input-list" class="space-y-2 mb-2"></div>
                    <button onclick="window.addIngredientRow()" class="text-xs bg-amber-50 text-amber-600 font-bold px-3 py-2 rounded-lg"><i class="fa-solid fa-plus"></i> ì¬ë£Œ ì¶”ê°€</button>
                </div>

                <!-- [NEW] ì¡°ë¦¬ ìˆœì„œ ì…ë ¥ (ì‹œê°„ ì„¤ì • í¬í•¨) -->
                <div>
                    <label class="block text-xs font-bold text-stone-500 mb-1">ì¡°ë¦¬ ìˆœì„œ</label>
                    <div id="step-input-list" class="space-y-2 mb-2"></div>
                    <button onclick="window.addStepRow()" class="text-xs bg-amber-50 text-amber-600 font-bold px-3 py-2 rounded-lg"><i class="fa-solid fa-plus"></i> ìˆœì„œ ì¶”ê°€</button>
                </div>
            </div>
            <button onclick="window.saveNewRecipe()" class="mt-4 w-full py-3 bg-amber-500 text-white font-bold rounded-xl shadow-md">ì„œë²„ì— ì €ì¥</button>
        </div>
    </div>
    
    <input type="file" id="file-input" accept="image/*" class="hidden" onchange="window.handleImageUpload(event)">

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, Timestamp, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // â–¼â–¼â–¼ ë³¸ì¸ì˜ Firebase í‚¤ê°’ìœ¼ë¡œ êµì²´í•˜ì„¸ìš” â–¼â–¼â–¼
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };
        // â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²

        let db;
        try {
            if (!firebaseConfig.apiKey.includes("YOUR_API_KEY")) {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                document.getElementById('server-status').classList.replace('bg-red-400', 'bg-green-400');
            }
        } catch(e) { console.error(e); }

        let recipes = [], currentRecipeIdx = 0;
        let coverImageBase64 = null;

        async function loadRecipes() {
            if(!db) { renderEmpty(); return; }
            try {
                const q = query(collection(db, "recipes"), orderBy("createdAt", "desc"));
                const snp = await getDocs(q);
                recipes=[]; 
                snp.forEach(d=>recipes.push({id:d.id,...d.data()}));
                if(recipes.length===0) renderEmpty();
                else window.renderRecipe(0);
            } catch(e) { renderEmpty(); }
        }

        function renderEmpty() {
            document.getElementById('recipe-container').innerHTML = `<div class="flex flex-col items-center justify-center h-full text-stone-400 px-6 text-center"><i class="fa-solid fa-plate-wheat text-6xl text-stone-200 mb-4"></i><h3 class="text-xl font-bold text-stone-600 mb-2">ë ˆì‹œí”¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3><p class="text-sm mb-6">ì˜¤ë¥¸ìª½ ìœ„ + ë²„íŠ¼ì„ ëˆŒëŸ¬<br>ì²« ë²ˆì§¸ ìš”ë¦¬ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”!</p></div>`;
        }

        function resizeImage(file, maxWidth) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        let width = img.width, height = img.height;
                        if (width > maxWidth) { height *= maxWidth / width; width = maxWidth; }
                        canvas.width = width; canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);
                        resolve(canvas.toDataURL('image/jpeg', 0.7));
                    }
                }
                reader.readAsDataURL(file);
            });
        }

        window.handleCoverUpload = async function(e) {
            const file = e.target.files[0];
            if(!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                const preview = document.getElementById('cover-preview');
                preview.src = ev.target.result;
                preview.classList.remove('hidden');
                document.getElementById('cover-placeholder').classList.add('hidden');
            }
            reader.readAsDataURL(file);
            coverImageBase64 = await resizeImage(file, 800);
        }
window.saveNewRecipe = async function() {
            if(!db) { alert("Firebase í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”."); return; }
            const title = document.getElementById('new-title').value;
            if(!title) { alert("ìš”ë¦¬ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤."); return; }

            // ì¬ë£Œ ìˆ˜ì§‘
            const ings=[]; 
            document.querySelectorAll('.ing-name').forEach((el,i)=> { if(el.value) ings.push({name:el.value, amount:document.querySelectorAll('.ing-amount')[i].value}); });

            // [NEW] ì¡°ë¦¬ ìˆœì„œ & íƒ€ì´ë¨¸ ìˆ˜ì§‘
            const steps=[];
            document.querySelectorAll('.step-text').forEach((el,i)=> {
                if(el.value) {
                    const timeVal = document.querySelectorAll('.step-time')[i].value;
                    const timerSec = timeVal ? parseInt(timeVal) * 60 : null; // ë¶„ -> ì´ˆ ë³€í™˜
                    steps.push({text:el.value, timer: timerSec});
                }
            });

            if(steps.length === 0) { alert("ìˆœì„œë¥¼ 1ê°œ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }

            const newRecipe = {
                title, subtitle: document.getElementById('new-subtitle').value,
                difficulty: "ë¯¸ì •", time: document.getElementById('new-time').value, servings: document.getElementById('new-servings').value,
                image: coverImageBase64 || "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800", 
                tag: "ë‚˜ë§Œì˜ ìš”ë¦¬", ingredients: ings, steps: steps,
                createdAt: Timestamp.now()
            };
            
            try {
                await addDoc(collection(db,"recipes"), newRecipe);
                alert("ì €ì¥ ì™„ë£Œ!"); window.closeAddRecipeModal(); loadRecipes();
            } catch(e) { alert("ì €ì¥ ì‹¤íŒ¨: " + e.message); }
        }

        window.renderRecipe = function(idx) {
            if(recipes.length===0) { renderEmpty(); return; }
            if(idx < 0) idx = 0; if(idx >= recipes.length) idx = recipes.length - 1;
            currentRecipeIdx = idx;

            const r = recipes[idx];
            const memories = window.getMemories(r.title);
            const container = document.getElementById('recipe-container');
            
            let ingHtml = r.ingredients.map((ing,i)=>`<div class="flex justify-between items-center bg-white p-3 rounded-xl border mb-2"><div class="flex gap-2"><input type="checkbox" id="ig-${i}"><label for="ig-${i}">${ing.name}</label></div><span class="text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded">${ing.amount||''}</span></div>`).join('');
            
            // [NEW] ì¡°ë¦¬ ìˆœì„œ ë Œë”ë§ (íƒ€ì´ë¨¸ ë²„íŠ¼ ìë™ ìƒì„±)
            let stepHtml = r.steps.map((st,i)=>`
                <div class="flex gap-4 mb-4 group">
                    <div class="w-8 h-8 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center font-bold text-sm shrink-0">${i+1}</div>
                    <div class="flex-1">
                        <p class="leading-relaxed cursor-pointer" onclick="this.classList.toggle('line-through'); this.classList.toggle('opacity-40')">${st.text}</p>
                        ${st.timer ? `<button onclick="window.setAndStartTimer(${st.timer}, event)" class="mt-2 flex items-center gap-1 text-xs bg-amber-50 hover:bg-amber-100 text-amber-700 px-3 py-2 rounded-lg font-bold transition"><i class="fa-solid fa-stopwatch"></i> ${Math.floor(st.timer/60)}ë¶„ íƒ€ì´ë¨¸ ì‹œì‘</button>` : ''}
                    </div>
                </div>`).join('');
            
            let memHtml = memories.map(m=>`<div class="relative"><p class="text-xs mb-1">ğŸ“… ${m.date}</p><img src="${m.image}" class="w-full rounded-lg shadow"><button onclick="window.delMem('${r.title}',${m.id})" class="absolute top-6 right-2 text-white bg-black/50 w-6 h-6 rounded-full text-xs">X</button></div>`).join('');

            container.innerHTML = `
                <div class="fade-in">
                    <div class="relative w-full h-64 bg-gray-200">
                        <img src="${r.image}" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-6 text-white"><h2 class="text-3xl font-serif font-bold drop-shadow-md">${r.title}</h2></div>
                        <button onclick="window.deleteRecipe('${r.id}')" class="absolute top-4 right-4 bg-black/40 hover:bg-red-500 text-white w-10 h-10 rounded-full backdrop-blur-sm transition flex items-center justify-center shadow-lg"><i class="fa-solid fa-trash"></i></button>
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between text-center mb-8 bg-white p-4 rounded-xl border"><div><p class="text-xs text-gray-400">ì‹œê°„</p><p class="font-bold">${r.time||'-'}</p></div><div class="w-px bg-gray-100"></div><div><p class="text-xs text-gray-400">ì¸ë¶„</p><p class="font-bold">${r.servings||'-'}</p></div><div class="w-px bg-gray-100"></div><div><p class="text-xs text-gray-400">ìˆœì„œ</p><p class="font-bold">${idx + 1}/${recipes.length}</p></div></div>
                        <h3 class="font-bold mb-4">ì¤€ë¹„ ì¬ë£Œ</h3><div class="mb-8">${ingHtml}</div>
                        <h3 class="font-bold mb-4">ì¡°ë¦¬ ìˆœì„œ</h3><div class="mb-8">${stepHtml}</div>
                        <h3 class="font-bold mb-4 flex justify-between">ì¶”ì–µ ì•¨ë²” <button onclick="window.triggerFile()" class="text-xs bg-amber-100 px-2 py-1 rounded text-amber-700">+ ì‚¬ì§„ ì¶”ê°€</button></h3>
                        <div class="space-y-4">${memHtml || '<p class="text-center text-xs text-gray-400 py-4 border border-dashed rounded">ì¶”ì–µì„ ë‚¨ê²¨ë³´ì„¸ìš”</p>'}</div>
                        <div class="h-10"></div>
                        ${recipes.length > 1 ? '<p class="text-center text-xs text-gray-400 pb-4">â†” ì¢Œìš°ë¡œ ë°€ì–´ì„œ ì´ë™</p>' : ''}
                    </div>
                </div>`;
        }

        // ìŠ¤ì™€ì´í”„
        let ts=0, te=0;
        const rc = document.getElementById('recipe-container');
        rc.addEventListener('touchstart', e=>ts=e.changedTouches[0].screenX, {passive:true});
        rc.addEventListener('touchend', e=>{ te=e.changedTouches[0].screenX; if(te>ts+50 && currentRecipeIdx>0) {currentRecipeIdx--; window.renderRecipe(currentRecipeIdx);} if(te<ts-50 && currentRecipeIdx<recipes.length-1){currentRecipeIdx++; window.renderRecipe(currentRecipeIdx);} }, {passive:true});

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ (ì‚¬ì§„)
        window.getMemories = t => JSON.parse(localStorage.getItem('daddys_mem')||'{}')[t]||[];
        window.saveMem = (t,d) => { const m=JSON.parse(localStorage.getItem('daddys_mem')||'{}'); if(!m[t])m[t]=[]; m[t].unshift({date:new Date().toLocaleDateString(), image:d, id:Date.now()}); try{localStorage.setItem('daddys_mem',JSON.stringify(m)); window.renderRecipe(currentRecipeIdx);}catch(e){alert("ìš©ëŸ‰ ë¶€ì¡±");} };
        window.delMem = (t,id) => { if(!confirm('ì‚­ì œ?'))return; const m=JSON.parse(localStorage.getItem('daddys_mem')||'{}'); m[t]=m[t].filter(x=>x.id!==id); localStorage.setItem('daddys_mem',JSON.stringify(m)); window.renderRecipe(currentRecipeIdx); };
        window.triggerFile = () => document.getElementById('file-input').click();
        window.handleImageUpload = e => { const f=e.target.files[0]; if(!f)return; const r=new FileReader(); r.onload=ev=>window.saveMem(recipes[currentRecipeIdx].title, ev.target.result); r.readAsDataURL(f); e.target.value=''; };
        window.deleteRecipe = async function(id) { if(!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return; try { await deleteDoc(doc(db, "recipes", id)); alert("ì‚­ì œë¨"); if(currentRecipeIdx >= recipes.length-1) currentRecipeIdx = Math.max(0, recipes.length-2); loadRecipes(); } catch(e) { alert(e.message); } }

        // ëª¨ë‹¬ & UI í—¬í¼
        const addModal = document.getElementById('add-recipe-modal');
        window.openAddRecipeModal = () => { 
            addModal.classList.remove('hidden'); 
            document.getElementById('cover-preview').classList.add('hidden');
            document.getElementById('cover-placeholder').classList.remove('hidden');
            document.getElementById('cover-input').value = '';
            coverImageBase64 = null;
            if(!document.getElementById('ingredient-input-list').children.length) window.addIngredientRow();
            if(!document.getElementById('step-input-list').children.length) window.addStepRow();
        };
        window.closeAddRecipeModal = () => addModal.classList.add('hidden');
        window.addIngredientRow = () => { const d=document.createElement('div'); d.className="flex gap-2 mb-2"; d.innerHTML=`<input class="ing-name border rounded px-2 py-1 w-full text-sm" placeholder="ì¬ë£Œ"><input class="ing-amount border rounded px-2 py-1 w-20 text-sm" placeholder="ì–‘"><button onclick="this.parentElement.remove()" class="text-red-400">X</button>`; document.getElementById('ingredient-input-list').appendChild(d); };
        
        // [NEW] ì¡°ë¦¬ ìˆœì„œ ì¶”ê°€ í•¨ìˆ˜
        window.addStepRow = () => {
            const d=document.createElement('div'); d.className="flex gap-2 mb-2 items-center";
            d.innerHTML=`<input class="step-text border rounded px-2 py-1 w-full text-sm" placeholder="ì„¤ëª…"><div class="flex items-center gap-1"><i class="fa-regular fa-clock text-stone-400 text-xs"></i><input type="number" class="step-time border rounded px-1 py-1 w-12 text-sm text-center" placeholder="ë¶„"></div><button onclick="this.parentElement.remove()" class="text-red-400 px-1">X</button>`;
            document.getElementById('step-input-list').appendChild(d);
        }

        // íƒ€ì´ë¨¸ & ì˜¤ë””ì˜¤
        let tt=0, ti;
        const tDisplay=document.getElementById('timer-display'), tBtn=document.getElementById('timer-btn');
        window.toggleTimerModal = () => document.getElementById('timer-modal').classList.toggle('hidden');
        window.setAndStartTimer = (s, e) => { if(e) e.stopPropagation(); tt=s; window.updateT(); document.getElementById('timer-modal').classList.remove('hidden'); window.stopTimer(); window.startTimer(); };
        window.updateT = () => tDisplay.innerText = `${Math.floor(tt/60).toString().padStart(2,'0')}:${(tt%60).toString().padStart(2,'0')}`;
        window.addTime = s => { tt+=s; window.updateT(); };
        window.resetTimer = () => { clearInterval(ti); tt=0; window.updateT(); };
        window.toggleTimer = () => { if(ti){clearInterval(ti);ti=null; tBtn.innerText="ì‹œì‘"; tBtn.classList.replace('bg-red-500','bg-amber-500');} else { window.startTimer(); } };
        window.startTimer = () => {
            tBtn.innerText="ì¼ì‹œì •ì§€"; tBtn.classList.replace('bg-amber-500','bg-red-500');
            ti = setInterval(()=>{ if(tt>0){tt--;window.updateT();}else{clearInterval(ti);ti=null;alert('ë!'); tBtn.innerText="ì‹œì‘"; tBtn.classList.replace('bg-red-500','bg-amber-500');} }, 1000);
        }
        window.stopTimer = () => { if(ti) clearInterval(ti); ti=null; tBtn.innerText="ì‹œì‘"; tBtn.classList.replace('bg-red-500','bg-amber-500'); }

        const audio = document.getElementById('audio-player');
        let play = false;
        window.togglePlay = () => { play=!play; play?audio.play():audio.pause(); document.getElementById('play-icon').className = play ? 'fa-solid fa-pause' : 'fa-solid fa-play'; };
        window.nextSong = () => { /* ê°„ì†Œí™”ë¨ */ audio.src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/ccCommunity/Chad_Crouch/Arps/Chad_Crouch_-_Elipsis.mp3"; if(play) audio.play(); };
        window.prevSong = window.nextSong;

        // ì‹œì‘
        window.nextSong(); 
        loadRecipes();
    </script>
</body>
</html>
		
